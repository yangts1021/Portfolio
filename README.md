[readme.md](https://github.com/user-attachments/files/24334419/readme.md)
# **投資組合追蹤器 (Portfolio Tracker)**

這是一個基於網頁的個人投資組合管理工具，專注於資產總覽、損益追蹤與風險曝險分析。採用單頁應用程式 (SPA) 架構，結合 Google Apps Script 實現資料同步。

## **✨ 主要功能清單**

### **1\. 核心架構與介面**

* **單頁應用程式 (SPA)**：基於 HTML / JavaScript / Tailwind CSS 構建，輕量且無需後端伺服器，直接在瀏覽器運行。  
* **資料持久化**：使用瀏覽器 localStorage 儲存所有交易紀錄、價格、匯率設定與資產數據，關閉網頁後資料不會遺失。  
* **響應式設計**：RWD 設計，完整支援桌機與行動裝置瀏覽。

### **2\. 交易紀錄管理 (Transactions)**

* **新增交易**：  
  * 支援日期、動作（買入/賣出）、代碼、券商、股數、單價、幣別輸入。  
  * **視覺化標示**：  
    * 券商專屬配色：國泰（綠）、富邦（淺藍）、元大（深藍）、台北富邦/Firstrade（灰）。  
    * 動作配色：買入（紅底白字）、賣出（綠底白字）。  
  * **自動同步**：新增交易時，若已設定 Google Apps Script (GAS)，系統會自動將資料寫入 Google Sheet。  
* **歷史列表**：以表格呈現所有交易紀錄，並支援單筆刪除功能。

### **3\. 資產總覽儀表板 (Overview Dashboard)**

將資產、負債、損益與分析整合於單一儀表板，提供全景視圖。

#### **A. 匯率與資產設定**

* **匯率設定**：專注於 **USD/TWD** 匯率，支援「手動輸入」或「自動抓取 (API)」兩種模式。  
* **其他資產與負債 (手動輸入)**：  
  * **類現金資產**：可輸入 TWD 與 USD 的閒置資金。  
  * **負債管理**：可輸入房貸、信貸、股票質押金額 (TWD)。  
  * **防誤觸機制**：輸入後需點擊「確認並重新計算」以更新總報表。

#### **B. 財務指標卡片**

儀表板分為四層結構，邏輯清晰：

1. **資產分佈**：證券市值、證券投入成本、其他類現金。  
2. **損益績效**：  
   * **未實現損益**：(現價 \- 平均成本) × 庫存，統一換算為 TWD。  
   * **已實現損益**：歷史賣出獲利加總。  
   * **總損益**：未實現 \+ 已實現 (顯示至整數位)。  
3. **資產負債表**：總資產 (股票+現金) vs 總負債。  
4. **淨值**：淨資產總額 (總資產 \- 總負債)。

#### **C. 曝險分析與圖表**

* **資產配置圓餅圖**：  
  * 使用 Chart.js 繪製。  
  * 具備 **自動拉線標籤 (Callout Labels)** 功能，直接在圖表外側顯示類別與佔比，避免標籤擠壓。  
* **Beta 曝險分析**：  
  * **自動分類**：依據 Beta 值自動歸類為「類現金 (Beta\<0.5)」、「原型 (0.5-1.4)」、「槓桿 (Beta\>1.4)」。  
  * **加權 Beta 計算**：將手動輸入的現金 (Beta=0) 納入分母計算，真實反映現金對投資組合波動的稀釋效果。

#### **D. 持倉狀況明細表**

* **即時資訊**：顯示代碼、庫存、即時價格 (來自 GAS)、市值、平均成本、未實現損益、報酬率、佔比。  
* **已清倉摺疊**：庫存為 0 的標的會自動歸類到「已清倉項目」並預設收折，保持版面清爽。  
* **浮動提示 (Tooltip)**：滑鼠移至「平均成本」與「未實現損益」時，會顯示背後的計算公式與原幣金額。

### **4\. 資料同步與整合 (Data Sync)**

* **Google Apps Script (GAS) 整合**：  
  * 改用 JSON 格式傳輸，取代傳統 CSV 匯入，提升穩定度與效率。  
  * **雙向整合**：  
    * **讀取 (GET)**：一次抓取「股票交易紀錄」與「即時價格與 Beta」兩個工作表。  
    * **寫入 (POST)**：新增交易時自動回寫至 Google Sheet。  
* **防呆機制**：代碼寫入時自動處理格式（如 00662），強制轉為字串，避免被試算表轉為數字。  
* **診斷模式**：若讀取失敗，提供 JSON 內容預覽視窗以利除錯。

## **🛠️ 技術棧**

* **Frontend**: HTML5, JavaScript (ES6+)  
* **Styling**: Tailwind CSS (CDN)  
* **Charts**: Chart.js  
* **Data Handling**: Native JSON fetch  
* **Backend Integration**: Google Apps Script (GAS)
