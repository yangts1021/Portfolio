# **投資組合追蹤器 (Portfolio Tracker) \- 功能摘要**

這是一個基於網頁 (HTML/JS) 的單頁應用程式 (SPA)，透過 Google Apps Script (GAS) 與 Google Sheet 進行資料庫連動，實現高度自動化的個人資產管理。

## **🚀 1\. 核心架構與資料整合**

* **雙向同步機制**：前端網頁與 Google Sheet 透過 GAS API 進行即時溝通。  
  * **讀取 (Read)**：一鍵同步所有資料，包含「交易紀錄」、「即時股價與 Beta」、「銀行餘額」、「質押紀錄」及「匯率」。  
  * **寫入 (Write)**：在網頁新增交易、質押紀錄或修改銀行餘額時，自動回寫至 Google Sheet，確保資料端同步。  
* **本地快取 (Local Caching)**：使用瀏覽器 localStorage 暫存資料，關閉網頁後資料不流失，且操作反應即時，無需每次重新讀取。  
* **RWD 響應式設計**：介面自動適應桌機與手機版面，隨時隨地皆可查看。

## **📊 2\. 資產總覽儀表板 (Dashboard)**

提供由上而下的財務全景視圖，整合所有關鍵指標。

* **財務指標卡片**：  
  * **資產分佈**：證券市值、證券總投入成本、其他類現金（自動由銀行系統匯總）。  
  * **損益績效**：未實現損益、已實現損益、總損益（數值皆四捨五入至整數位，保持介面清爽）。  
  * **資產負債表**：總資產 (股票+現金) vs 總負債 (房貸+信貸+質押)。  
  * **淨值**：總資產減去總負債的最終淨值。  
* **視覺化分析**：  
  * **資產配置圓餅圖**：顯示「原型、槓桿、類現金」佔比，具備自動拉線標籤 (Callout Labels) 功能。  
  * **Beta 曝險分析**：計算投資組合的加權 Beta 值（將現金視為 Beta 0 納入計算，真實反映曝險稀釋效果）。  
* **持倉明細表**：  
  * 即時計算個股的市值、平均成本、未實現損益 (TWD)、報酬率與佔比。  
  * **已清倉摺疊**：庫存為 0 的標的自動歸類至下方摺疊區。  
  * **平均成本邏輯**：採移動平均法，若庫存歸零後再買進，成本會重置計算。  
* **匯率設定**：  
  * 整合於現金卡片中，支援手動輸入或由 Google Sheet (Admin\_Dashboard) 自動帶入。

## **📝 3\. 交易紀錄管理**

* **新增交易**：  
  * 支援輸入日期、動作 (買/賣)、代碼、券商、股數、單價、幣別。  
  * **代碼防呆**：寫入 Sheet 時自動處理 00662 等代碼格式，強制轉為字串。  
  * **券商標示**：支援不同券商的顏色標籤 (國泰、富邦、元大等)。  
* **歷史列表**：顯示所有交易明細，並支援單筆刪除 (同步刪除本地資料)。

## **🏦 4\. 銀行系統餘額管理**

* **帳戶管理**：  
  * 列表顯示各家銀行的 USD、TWD 餘額及貸款金額。  
  * **即時編輯**：直接在表格上修改金額，失去焦點後自動同步更新至 Google Sheet。  
* **自動匯總**：  
  * 頁面上方顯示所有銀行的 USD 與 TWD 總額。  
  * 此總額會**自動流向**「資產總覽」的現金與負債欄位，無需重複輸入。  
* **貸款分類自動化**：  
  * 系統自動識別「台北富邦」的貸款歸類為**房貸**。  
  * 系統自動識別「中國信託」的貸款歸類為**信貸**。

## **💸 5\. 股票質押管理**

* **新增質借**：  
  * 輸入匯撥資訊與借款條件。  
  * **自動計算**：  
    * 輸入代碼與股數後，自動帶入現價計算「擔保價值」。  
    * 輸入借款日，自動推算半年後的「還款日期」。  
* **風險監控**：  
  * **整戶維持率**：即時計算 (總擔保市值 / 總借款) %，並以紅/黃/綠燈號示警 (標準為 130% / 140% / \>166%)。  
  * **利息試算**：依據借款天數動態計算累積利息。  
* **自動化負債**：質押的總借款金額會自動匯總並顯示於「資產總覽」的負債欄位中。

## **🛠️ 技術總結**

這是一個**高度自動化**的個人資產管理系統，透過 Google Sheet 當作後端資料庫，讓使用者在前端網頁就能完成記帳、資產更新與風險控管，且所有關鍵財務數據 (現金、負債、股價、匯率) 均已實現連動，大幅減少手動維護的成本。
